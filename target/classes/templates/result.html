<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>StepPair 디버그</title>
  <link rel="stylesheet" type="text/css" href="/css/result.css">

</head>
<body>

<h1>StepPair 디버그</h1>
<p><strong>TEST CASE NAME:</strong> <span th:text="${testCaseName}">-</span></p>
<p><strong>NOTE:</strong> <span th:text="${note}">-</span></p>

<div th:each="scenario : ${scenarios}">
  <h2 th:text="${scenario.name}">시나리오명</h2>
  <p><strong>StepPair 수:</strong> <span th:text="${scenario.stepPairs.size()}">0</span></p>

  <div th:each="pair, idx : ${scenario.stepPairs}">
    <div class="debug-block">
      <p>pair [[${idx.index}]]: <span th:text="${pair}">-</span></p>
      <p>↳ input: <span th:text="${pair.input}">-</span></p>
      <p>↳ output: <span th:text="${pair.output}">-</span></p>
    </div>

    <table>
      <thead>
      <tr>
        <th th:each="entry : ${pair.input.entrySet()}" class="header" th:text="${entry.key}">입력헤더</th>
        <th style="background-color:black;"></th>
        <th th:each="entry : ${pair.output.entrySet()}" class="header"
            th:if="${entry.key != 'result'}"
            th:text="${entry.key}">출력헤더</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td th:each="entry : ${pair.input.entrySet()}" th:text="${entry.value}">-</td>
        <td style="background-color:black;"></td>

        <td th:each="entry : ${pair.output.entrySet()}" th:if="${entry.key != 'result'}">
          <div th:with="val=${entry.value}, parts=${#strings.arraySplit(val, ';')}">
            <div th:if="${#lists.size(parts) == 3}">
              <div th:if="${val.startsWith('OK')}" class="green-bg" th:text="${parts[2]}"></div>
              <div th:if="${val.startsWith('FAIL')}" class="red-bg">
                <div th:text="${parts[1]}"></div>
                <div style="border-top: solid 1px;" th:text="${parts[2]}"></div>
              </div>
              <div th:if="${!val.startsWith('OK') and !val.startsWith('FAIL')}" class="center" th:text="${val}"></div>
            </div>
            <div th:if="${#lists.size(parts) != 3}" th:text="${val}">-</div>
          </div>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

</body>
</html>
